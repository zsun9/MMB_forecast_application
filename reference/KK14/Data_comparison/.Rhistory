series.data.CPROFIT <- as.data.frame(fredr_series_observations(series_id = "CPROFIT", frequency = "q", vintage_dates = closest_date))
series.data.CPROFIT$date <- as.Date(series.data.CPROFIT$date)
names(series.data.CPROFIT)[names(series.data.CPROFIT) == "value"] <- "CPROFIT"
series.data.CPROFIT = series.data.CPROFIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "BOGZ1FA086130003Q")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.interestinc <- as.data.frame(fredr_series_observations(series_id = "BOGZ1FA086130003Q", frequency = "q", vintage_dates = closest_date))
series.data.interestinc$date <- as.Date(series.data.interestinc$date)
names(series.data.interestinc)[names(series.data.interestinc) == "value"] <- "interestinc"
series.data.interestinc = series.data.interestinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B075RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CT <- as.data.frame(fredr_series_observations(series_id = "B075RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CT$date <- as.Date(series.data.CT$date)
names(series.data.CT)[names(series.data.CT) == "value"] <- "CT"
series.data.CT = series.data.CT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B249RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PT <- as.data.frame(fredr_series_observations(series_id = "B249RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.PT$date <- as.Date(series.data.PT$date)
names(series.data.PT)[names(series.data.PT) == "value"] <- "PT"
series.data.PT = series.data.PT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CNP16OV")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.pop <- as.data.frame(fredr_series_observations(series_id = "CNP16OV", frequency = "q", vintage_dates = closest_date))
series.data.pop$date <- as.Date(series.data.pop$date)
series.data.pop[, "value"] = series.data.pop[, "value"]/series.data.pop[series.data.pop$date == "2005-10-01","value"]
names(series.data.pop)[names(series.data.pop) == "value"] <- "popindex"
series.data.pop = series.data.pop[,-2]
series.data.joint=inner_join(series.data.CSI, series.data.EC, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.IT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.SIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PRI, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.W, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.rentalinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CPROFIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.interestinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.pop, by = "date", copy = FALSE)
# get capital income
series.data.CI = series.data.joint$rentalinc+series.data.joint$CPROFIT+series.data.joint$interestinc+series.data.joint$PRI/2
series.data.joint = cbind(series.data.joint, "CI" = series.data.CI)
jointab = series.data.joint
# calculate labor tax rate
tau_w = ((jointab$IT+jointab$SIT)/(jointab$W+jointab$PRI/2+jointab$CI))*((jointab$W+jointab$PRI/2)/(jointab$EC+jointab$PRI/2))+jointab$CSI/(jointab$EC+jointab$PRI/2)
ln_tau_w = log(tau_w)
jointab = cbind(jointab ,"tau_w" =tau_w , "ln_tau_w" =ln_tau_w)
tau_k = (jointab$IT/(jointab$W + jointab$PRI/2 + jointab$CI))*(jointab$CI/(jointab$CI + jointab$PT)) + (jointab$CT + jointab$PT)/(jointab$CI + jointab$PT)
ln_tau_k = log(tau_k)
jointab = cbind(jointab ,"tau_k" =tau_k,"ln_tau_k"=ln_tau_k )
tax_rate_table = jointab[,c("date","ln_tau_w","ln_tau_k")]
tax_rate_table = betweendates(DATE1,DATE2,tax_rate_table)
tax_rate_table[,"ln_tau_w"] = tax_rate_table[,"ln_tau_w"] - mean(tax_rate_table[,"ln_tau_w"] )
tax_rate_table[,"ln_tau_k"] = tax_rate_table[,"ln_tau_k"] - mean(tax_rate_table[,"ln_tau_k"] )
series.data6 <- as.data.frame(read_excel("GDPCTPIindex2005.xls",sheet = "FRED"))
series.data6$date <- as.Date(series.data6$date)
View(series.data6)
# === To get b_obs  government debt per capita, we need to get gov expenditure + transfer - tax reveunes plus interest payment =============
if (exists("RunALL") == FALSE ) {source("housekeeping.R")} else if (RunALL==0){source("housekeeping.R")}
# get tax rate
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W780RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CSI <- as.data.frame(fredr_series_observations(series_id = "W780RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CSI$date <- as.Date(series.data.CSI$date)
names(series.data.CSI)[names(series.data.CSI) == "value"] <- "CSI"
series.data.CSI = series.data.CSI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "COE")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.EC <- as.data.frame(fredr_series_observations(series_id = "COE", frequency = "q", vintage_dates = closest_date))
series.data.EC$date <- as.Date(series.data.EC$date)
names(series.data.EC)[names(series.data.EC) == "value"] <- "EC"
series.data.EC = series.data.EC[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "A074RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.IT <- as.data.frame(fredr_series_observations(series_id = "A074RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.IT$date <- as.Date(series.data.IT$date)
names(series.data.IT)[names(series.data.IT) == "value"] <- "IT"
series.data.IT = series.data.IT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W071RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.SIT <- as.data.frame(fredr_series_observations(series_id = "W071RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.SIT$date <- as.Date(series.data.SIT$date)
names(series.data.SIT)[names(series.data.SIT) == "value"] <- "SIT"
series.data.SIT = series.data.SIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "PROPINC")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PRI <- as.data.frame(fredr_series_observations(series_id = "PROPINC", frequency = "q", vintage_dates = closest_date))
series.data.PRI$date <- as.Date(series.data.PRI$date)
names(series.data.PRI)[names(series.data.PRI) == "value"] <- "PRI"
series.data.PRI = series.data.PRI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "WASCUR")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.W <- as.data.frame(fredr_series_observations(series_id = "WASCUR", frequency = "q", vintage_dates = closest_date))
series.data.W$date <- as.Date(series.data.W$date)
names(series.data.W)[names(series.data.W) == "value"] <- "W"
series.data.W = series.data.W[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "RENTIN")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.rentalinc <- as.data.frame(fredr_series_observations(series_id = "RENTIN", frequency = "q", vintage_dates = closest_date))
series.data.rentalinc$date <- as.Date(series.data.rentalinc$date)
names(series.data.rentalinc)[names(series.data.rentalinc) == "value"] <- "rentalinc"
series.data.rentalinc = series.data.rentalinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CPROFIT")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CPROFIT <- as.data.frame(fredr_series_observations(series_id = "CPROFIT", frequency = "q", vintage_dates = closest_date))
series.data.CPROFIT$date <- as.Date(series.data.CPROFIT$date)
names(series.data.CPROFIT)[names(series.data.CPROFIT) == "value"] <- "CPROFIT"
series.data.CPROFIT = series.data.CPROFIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "BOGZ1FA086130003Q")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.interestinc <- as.data.frame(fredr_series_observations(series_id = "BOGZ1FA086130003Q", frequency = "q", vintage_dates = closest_date))
series.data.interestinc$date <- as.Date(series.data.interestinc$date)
names(series.data.interestinc)[names(series.data.interestinc) == "value"] <- "interestinc"
series.data.interestinc = series.data.interestinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B075RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CT <- as.data.frame(fredr_series_observations(series_id = "B075RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CT$date <- as.Date(series.data.CT$date)
names(series.data.CT)[names(series.data.CT) == "value"] <- "CT"
series.data.CT = series.data.CT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B249RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PT <- as.data.frame(fredr_series_observations(series_id = "B249RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.PT$date <- as.Date(series.data.PT$date)
names(series.data.PT)[names(series.data.PT) == "value"] <- "PT"
series.data.PT = series.data.PT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CNP16OV")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.pop <- as.data.frame(fredr_series_observations(series_id = "CNP16OV", frequency = "q", vintage_dates = closest_date))
series.data.pop$date <- as.Date(series.data.pop$date)
series.data.pop[, "value"] = series.data.pop[, "value"]/series.data.pop[series.data.pop$date == "2005-10-01","value"]
names(series.data.pop)[names(series.data.pop) == "value"] <- "popindex"
series.data.pop = series.data.pop[,-2]
series.data.def <- as.data.frame(read_excel("GDPCTPIindex2005.xls",sheet = "FRED"))
series.data.def$date <- as.Date(series.data.def$date)
names(series.data.def)[names(series.data.def) == "value"] <- "deflator"
series.data.joint=inner_join(series.data.CSI, series.data.EC, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.IT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.SIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PRI, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.W, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.rentalinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CPROFIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.interestinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.pop, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.def, by = "date", copy = FALSE)
# get capital income
series.data.CI = series.data.joint$rentalinc+series.data.joint$CPROFIT+series.data.joint$interestinc+series.data.joint$PRI/2
series.data.joint = cbind(series.data.joint, "CI" = series.data.CI)
jointab = series.data.joint
# calculate labor tax rate
tau_w = ((jointab$IT+jointab$SIT)/(jointab$W+jointab$PRI/2+jointab$CI))*((jointab$W+jointab$PRI/2)/(jointab$EC+jointab$PRI/2))+jointab$CSI/(jointab$EC+jointab$PRI/2)
ln_tau_w = log(tau_w)
jointab = cbind(jointab ,"tau_w" =tau_w , "ln_tau_w" =ln_tau_w)
tau_k = (jointab$IT/(jointab$W + jointab$PRI/2 + jointab$CI))*(jointab$CI/(jointab$CI + jointab$PT)) + (jointab$CT + jointab$PT)/(jointab$CI + jointab$PT)
ln_tau_k = log(tau_k)
jointab = cbind(jointab ,"tau_k" =tau_k,"ln_tau_k"=ln_tau_k )
tax_rate_table = jointab[,c("date","ln_tau_w","ln_tau_k")]
tax_rate_table = betweendates(DATE1,DATE2,tax_rate_table)
tax_rate_table[,"ln_tau_w"] = tax_rate_table[,"ln_tau_w"] - mean(tax_rate_table[,"ln_tau_w"] )
tax_rate_table[,"ln_tau_k"] = tax_rate_table[,"ln_tau_k"] - mean(tax_rate_table[,"ln_tau_k"] )
View(series.data.def)
names(series.data.def)[2] <- "deflator"
View(series.data.def)
# === To get b_obs  government debt per capita, we need to get gov expenditure + transfer - tax reveunes plus interest payment =============
if (exists("RunALL") == FALSE ) {source("housekeeping.R")} else if (RunALL==0){source("housekeeping.R")}
# get tax rate
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W780RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CSI <- as.data.frame(fredr_series_observations(series_id = "W780RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CSI$date <- as.Date(series.data.CSI$date)
names(series.data.CSI)[names(series.data.CSI) == "value"] <- "CSI"
series.data.CSI = series.data.CSI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "COE")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.EC <- as.data.frame(fredr_series_observations(series_id = "COE", frequency = "q", vintage_dates = closest_date))
series.data.EC$date <- as.Date(series.data.EC$date)
names(series.data.EC)[names(series.data.EC) == "value"] <- "EC"
series.data.EC = series.data.EC[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "A074RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.IT <- as.data.frame(fredr_series_observations(series_id = "A074RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.IT$date <- as.Date(series.data.IT$date)
names(series.data.IT)[names(series.data.IT) == "value"] <- "IT"
series.data.IT = series.data.IT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W071RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.SIT <- as.data.frame(fredr_series_observations(series_id = "W071RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.SIT$date <- as.Date(series.data.SIT$date)
names(series.data.SIT)[names(series.data.SIT) == "value"] <- "SIT"
series.data.SIT = series.data.SIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "PROPINC")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PRI <- as.data.frame(fredr_series_observations(series_id = "PROPINC", frequency = "q", vintage_dates = closest_date))
series.data.PRI$date <- as.Date(series.data.PRI$date)
names(series.data.PRI)[names(series.data.PRI) == "value"] <- "PRI"
series.data.PRI = series.data.PRI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "WASCUR")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.W <- as.data.frame(fredr_series_observations(series_id = "WASCUR", frequency = "q", vintage_dates = closest_date))
series.data.W$date <- as.Date(series.data.W$date)
names(series.data.W)[names(series.data.W) == "value"] <- "W"
series.data.W = series.data.W[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "RENTIN")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.rentalinc <- as.data.frame(fredr_series_observations(series_id = "RENTIN", frequency = "q", vintage_dates = closest_date))
series.data.rentalinc$date <- as.Date(series.data.rentalinc$date)
names(series.data.rentalinc)[names(series.data.rentalinc) == "value"] <- "rentalinc"
series.data.rentalinc = series.data.rentalinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CPROFIT")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CPROFIT <- as.data.frame(fredr_series_observations(series_id = "CPROFIT", frequency = "q", vintage_dates = closest_date))
series.data.CPROFIT$date <- as.Date(series.data.CPROFIT$date)
names(series.data.CPROFIT)[names(series.data.CPROFIT) == "value"] <- "CPROFIT"
series.data.CPROFIT = series.data.CPROFIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "BOGZ1FA086130003Q")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.interestinc <- as.data.frame(fredr_series_observations(series_id = "BOGZ1FA086130003Q", frequency = "q", vintage_dates = closest_date))
series.data.interestinc$date <- as.Date(series.data.interestinc$date)
names(series.data.interestinc)[names(series.data.interestinc) == "value"] <- "interestinc"
series.data.interestinc = series.data.interestinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B075RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CT <- as.data.frame(fredr_series_observations(series_id = "B075RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CT$date <- as.Date(series.data.CT$date)
names(series.data.CT)[names(series.data.CT) == "value"] <- "CT"
series.data.CT = series.data.CT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B249RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PT <- as.data.frame(fredr_series_observations(series_id = "B249RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.PT$date <- as.Date(series.data.PT$date)
names(series.data.PT)[names(series.data.PT) == "value"] <- "PT"
series.data.PT = series.data.PT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CNP16OV")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.pop <- as.data.frame(fredr_series_observations(series_id = "CNP16OV", frequency = "q", vintage_dates = closest_date))
series.data.pop$date <- as.Date(series.data.pop$date)
series.data.pop[, "value"] = series.data.pop[, "value"]/series.data.pop[series.data.pop$date == "2005-10-01","value"]
names(series.data.pop)[names(series.data.pop) == "value"] <- "popindex"
series.data.pop = series.data.pop[,-2]
series.data.def <- as.data.frame(read_excel("GDPCTPIindex2005.xls",sheet = "FRED"))
series.data.def$date <- as.Date(series.data.def$date)
names(series.data.def)[2] <- "deflator"
series.data.joint=inner_join(series.data.CSI, series.data.EC, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.IT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.SIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PRI, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.W, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.rentalinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CPROFIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.interestinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.pop, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.def, by = "date", copy = FALSE)
# get capital income
series.data.CI = series.data.joint$rentalinc+series.data.joint$CPROFIT+series.data.joint$interestinc+series.data.joint$PRI/2
series.data.joint = cbind(series.data.joint, "CI" = series.data.CI)
jointab = series.data.joint
# calculate labor tax rate
tau_w = ((jointab$IT+jointab$SIT)/(jointab$W+jointab$PRI/2+jointab$CI))*((jointab$W+jointab$PRI/2)/(jointab$EC+jointab$PRI/2))+jointab$CSI/(jointab$EC+jointab$PRI/2)
ln_tau_w = log(tau_w)
jointab = cbind(jointab ,"tau_w" =tau_w , "ln_tau_w" =ln_tau_w)
tau_k = (jointab$IT/(jointab$W + jointab$PRI/2 + jointab$CI))*(jointab$CI/(jointab$CI + jointab$PT)) + (jointab$CT + jointab$PT)/(jointab$CI + jointab$PT)
ln_tau_k = log(tau_k)
jointab = cbind(jointab ,"tau_k" =tau_k,"ln_tau_k"=ln_tau_k )
tax_rate_table = jointab[,c("date","ln_tau_w","ln_tau_k")]
tax_rate_table = betweendates(DATE1,DATE2,tax_rate_table)
tax_rate_table[,"ln_tau_w"] = tax_rate_table[,"ln_tau_w"] - mean(tax_rate_table[,"ln_tau_w"] )
tax_rate_table[,"ln_tau_k"] = tax_rate_table[,"ln_tau_k"] - mean(tax_rate_table[,"ln_tau_k"] )
if (exists("RunALL") == FALSE ) {source("housekeeping.R")} else if (RunALL==0){source("housekeeping.R")}
# get tax rate
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W780RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CSI <- as.data.frame(fredr_series_observations(series_id = "W780RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CSI$date <- as.Date(series.data.CSI$date)
names(series.data.CSI)[names(series.data.CSI) == "value"] <- "CSI"
series.data.CSI = series.data.CSI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "COE")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.EC <- as.data.frame(fredr_series_observations(series_id = "COE", frequency = "q", vintage_dates = closest_date))
series.data.EC$date <- as.Date(series.data.EC$date)
names(series.data.EC)[names(series.data.EC) == "value"] <- "EC"
series.data.EC = series.data.EC[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "A074RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.IT <- as.data.frame(fredr_series_observations(series_id = "A074RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.IT$date <- as.Date(series.data.IT$date)
names(series.data.IT)[names(series.data.IT) == "value"] <- "IT"
series.data.IT = series.data.IT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W071RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.SIT <- as.data.frame(fredr_series_observations(series_id = "W071RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.SIT$date <- as.Date(series.data.SIT$date)
names(series.data.SIT)[names(series.data.SIT) == "value"] <- "SIT"
series.data.SIT = series.data.SIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "PROPINC")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PRI <- as.data.frame(fredr_series_observations(series_id = "PROPINC", frequency = "q", vintage_dates = closest_date))
series.data.PRI$date <- as.Date(series.data.PRI$date)
names(series.data.PRI)[names(series.data.PRI) == "value"] <- "PRI"
series.data.PRI = series.data.PRI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "WASCUR")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.W <- as.data.frame(fredr_series_observations(series_id = "WASCUR", frequency = "q", vintage_dates = closest_date))
series.data.W$date <- as.Date(series.data.W$date)
names(series.data.W)[names(series.data.W) == "value"] <- "W"
series.data.W = series.data.W[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "RENTIN")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.rentalinc <- as.data.frame(fredr_series_observations(series_id = "RENTIN", frequency = "q", vintage_dates = closest_date))
series.data.rentalinc$date <- as.Date(series.data.rentalinc$date)
names(series.data.rentalinc)[names(series.data.rentalinc) == "value"] <- "rentalinc"
series.data.rentalinc = series.data.rentalinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CPROFIT")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CPROFIT <- as.data.frame(fredr_series_observations(series_id = "CPROFIT", frequency = "q", vintage_dates = closest_date))
series.data.CPROFIT$date <- as.Date(series.data.CPROFIT$date)
names(series.data.CPROFIT)[names(series.data.CPROFIT) == "value"] <- "CPROFIT"
series.data.CPROFIT = series.data.CPROFIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "BOGZ1FA086130003Q")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.interestinc <- as.data.frame(fredr_series_observations(series_id = "BOGZ1FA086130003Q", frequency = "q", vintage_dates = closest_date))
series.data.interestinc$date <- as.Date(series.data.interestinc$date)
names(series.data.interestinc)[names(series.data.interestinc) == "value"] <- "interestinc"
series.data.interestinc = series.data.interestinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B075RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CT <- as.data.frame(fredr_series_observations(series_id = "B075RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CT$date <- as.Date(series.data.CT$date)
names(series.data.CT)[names(series.data.CT) == "value"] <- "CT"
series.data.CT = series.data.CT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B249RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PT <- as.data.frame(fredr_series_observations(series_id = "B249RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.PT$date <- as.Date(series.data.PT$date)
names(series.data.PT)[names(series.data.PT) == "value"] <- "PT"
series.data.PT = series.data.PT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CNP16OV")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.pop <- as.data.frame(fredr_series_observations(series_id = "CNP16OV", frequency = "q", vintage_dates = closest_date))
series.data.pop$date <- as.Date(series.data.pop$date)
series.data.pop[, "value"] = series.data.pop[, "value"]/series.data.pop[series.data.pop$date == "2005-10-01","value"]
names(series.data.pop)[names(series.data.pop) == "value"] <- "popindex"
series.data.pop = series.data.pop[,-2]
series.data.def <- as.data.frame(read_excel("GDPCTPIindex2005.xls",sheet = "FRED"))
series.data.def$date <- as.Date(series.data.def$date)
names(series.data.def)[2] <- "deflator"
series.data.joint=inner_join(series.data.CSI, series.data.EC, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.IT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.SIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PRI, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.W, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.rentalinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CPROFIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.interestinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.pop, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.def, by = "date", copy = FALSE)
# get capital income
series.data.CI = series.data.joint$rentalinc+series.data.joint$CPROFIT+series.data.joint$interestinc+series.data.joint$PRI/2
series.data.joint = cbind(series.data.joint, "CI" = series.data.CI)
jointab = series.data.joint
# calculate labor tax rate
tau_w = ((jointab$IT+jointab$SIT)/(jointab$W+jointab$PRI/2+jointab$CI))*((jointab$W+jointab$PRI/2)/(jointab$EC+jointab$PRI/2))+jointab$CSI/(jointab$EC+jointab$PRI/2)
ln_tau_w = log(tau_w)
jointab = cbind(jointab ,"tau_w" =tau_w , "ln_tau_w" =ln_tau_w)
tau_k = (jointab$IT/(jointab$W + jointab$PRI/2 + jointab$CI))*(jointab$CI/(jointab$CI + jointab$PT)) + (jointab$CT + jointab$PT)/(jointab$CI + jointab$PT)
ln_tau_k = log(tau_k)
jointab = cbind(jointab ,"tau_k" =tau_k,"ln_tau_k"=ln_tau_k )
tax_rate_table = jointab[,c("date","ln_tau_w","ln_tau_k")]
tax_rate_table = betweendates(DATE1,DATE2,tax_rate_table)
tax_rate_table[,"ln_tau_w"] = tax_rate_table[,"ln_tau_w"] - mean(tax_rate_table[,"ln_tau_w"] )
tax_rate_table[,"ln_tau_k"] = tax_rate_table[,"ln_tau_k"] - mean(tax_rate_table[,"ln_tau_k"] )
# now calculate gov tax revenue
ln_taxrev = log((jointab$tau_w*(jointab$EC + jointab$PRI/2) + jointab$tau_k*(jointab$CI + jointab$PT))/(jointab$popindex*jointab$deflator))
jointab = cbind(jointab ,"ln_taxrev" =ln_taxrev )
View(jointab)
tax_obs = cbind(jointab$date, jointab$ln_taxrev)
View(tax_obs)
tax_obs = cbind("date"= as.Date(jointab$date) , "ln_taxrev" = jointab$ln_taxrev)
View(tax_obs)
tax_obs = jointab[, c("date" , "ln_taxrev")]
View(tax_obs)
# === To get b_obs  government debt per capita, we need to get gov expenditure + transfer - tax reveunes plus interest payment =============
if (exists("RunALL") == FALSE ) {source("housekeeping.R")} else if (RunALL==0){source("housekeeping.R")}
# get tax rate
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W780RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CSI <- as.data.frame(fredr_series_observations(series_id = "W780RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CSI$date <- as.Date(series.data.CSI$date)
names(series.data.CSI)[names(series.data.CSI) == "value"] <- "CSI"
series.data.CSI = series.data.CSI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "COE")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.EC <- as.data.frame(fredr_series_observations(series_id = "COE", frequency = "q", vintage_dates = closest_date))
series.data.EC$date <- as.Date(series.data.EC$date)
names(series.data.EC)[names(series.data.EC) == "value"] <- "EC"
series.data.EC = series.data.EC[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "A074RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.IT <- as.data.frame(fredr_series_observations(series_id = "A074RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.IT$date <- as.Date(series.data.IT$date)
names(series.data.IT)[names(series.data.IT) == "value"] <- "IT"
series.data.IT = series.data.IT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W071RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.SIT <- as.data.frame(fredr_series_observations(series_id = "W071RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.SIT$date <- as.Date(series.data.SIT$date)
names(series.data.SIT)[names(series.data.SIT) == "value"] <- "SIT"
series.data.SIT = series.data.SIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "PROPINC")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PRI <- as.data.frame(fredr_series_observations(series_id = "PROPINC", frequency = "q", vintage_dates = closest_date))
series.data.PRI$date <- as.Date(series.data.PRI$date)
names(series.data.PRI)[names(series.data.PRI) == "value"] <- "PRI"
series.data.PRI = series.data.PRI[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "WASCUR")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.W <- as.data.frame(fredr_series_observations(series_id = "WASCUR", frequency = "q", vintage_dates = closest_date))
series.data.W$date <- as.Date(series.data.W$date)
names(series.data.W)[names(series.data.W) == "value"] <- "W"
series.data.W = series.data.W[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "RENTIN")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.rentalinc <- as.data.frame(fredr_series_observations(series_id = "RENTIN", frequency = "q", vintage_dates = closest_date))
series.data.rentalinc$date <- as.Date(series.data.rentalinc$date)
names(series.data.rentalinc)[names(series.data.rentalinc) == "value"] <- "rentalinc"
series.data.rentalinc = series.data.rentalinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CPROFIT")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CPROFIT <- as.data.frame(fredr_series_observations(series_id = "CPROFIT", frequency = "q", vintage_dates = closest_date))
series.data.CPROFIT$date <- as.Date(series.data.CPROFIT$date)
names(series.data.CPROFIT)[names(series.data.CPROFIT) == "value"] <- "CPROFIT"
series.data.CPROFIT = series.data.CPROFIT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "BOGZ1FA086130003Q")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.interestinc <- as.data.frame(fredr_series_observations(series_id = "BOGZ1FA086130003Q", frequency = "q", vintage_dates = closest_date))
series.data.interestinc$date <- as.Date(series.data.interestinc$date)
names(series.data.interestinc)[names(series.data.interestinc) == "value"] <- "interestinc"
series.data.interestinc = series.data.interestinc[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B075RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.CT <- as.data.frame(fredr_series_observations(series_id = "B075RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.CT$date <- as.Date(series.data.CT$date)
names(series.data.CT)[names(series.data.CT) == "value"] <- "CT"
series.data.CT = series.data.CT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "B249RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.PT <- as.data.frame(fredr_series_observations(series_id = "B249RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.PT$date <- as.Date(series.data.PT$date)
names(series.data.PT)[names(series.data.PT) == "value"] <- "PT"
series.data.PT = series.data.PT[,-2]
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "CNP16OV")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.pop <- as.data.frame(fredr_series_observations(series_id = "CNP16OV", frequency = "q", vintage_dates = closest_date))
series.data.pop$date <- as.Date(series.data.pop$date)
series.data.pop[, "value"] = series.data.pop[, "value"]/series.data.pop[series.data.pop$date == "2005-10-01","value"]
names(series.data.pop)[names(series.data.pop) == "value"] <- "popindex"
series.data.pop = series.data.pop[,-2]
series.data.def <- as.data.frame(read_excel("GDPCTPIindex2005.xls",sheet = "FRED"))
series.data.def$date <- as.Date(series.data.def$date)
names(series.data.def)[2] <- "deflator"
series.data.joint=inner_join(series.data.CSI, series.data.EC, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.IT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.SIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PRI, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.W, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.rentalinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CPROFIT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.interestinc, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.CT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.PT, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.pop, by = "date", copy = FALSE)
series.data.joint=inner_join(series.data.joint, series.data.def, by = "date", copy = FALSE)
# get capital income
series.data.CI = series.data.joint$rentalinc+series.data.joint$CPROFIT+series.data.joint$interestinc+series.data.joint$PRI/2
series.data.joint = cbind(series.data.joint, "CI" = series.data.CI)
jointab = series.data.joint
# calculate labor tax rate
tau_w = ((jointab$IT+jointab$SIT)/(jointab$W+jointab$PRI/2+jointab$CI))*((jointab$W+jointab$PRI/2)/(jointab$EC+jointab$PRI/2))+jointab$CSI/(jointab$EC+jointab$PRI/2)
ln_tau_w = log(tau_w)
jointab = cbind(jointab ,"tau_w" =tau_w , "ln_tau_w" =ln_tau_w)
tau_k = (jointab$IT/(jointab$W + jointab$PRI/2 + jointab$CI))*(jointab$CI/(jointab$CI + jointab$PT)) + (jointab$CT + jointab$PT)/(jointab$CI + jointab$PT)
ln_tau_k = log(tau_k)
jointab = cbind(jointab ,"tau_k" =tau_k,"ln_tau_k"=ln_tau_k )
tax_rate_table = jointab[,c("date","ln_tau_w","ln_tau_k")]
tax_rate_table = betweendates(DATE1,DATE2,tax_rate_table)
tax_rate_table[,"ln_tau_w"] = tax_rate_table[,"ln_tau_w"] - mean(tax_rate_table[,"ln_tau_w"] )
tax_rate_table[,"ln_tau_k"] = tax_rate_table[,"ln_tau_k"] - mean(tax_rate_table[,"ln_tau_k"] )
datalist[["tax_rate_table"]] <- tax_rate_table
# now calculate tax_obs (gov tax revenue)
ln_taxrev = log((jointab$tau_w*(jointab$EC + jointab$PRI/2) + jointab$tau_k*(jointab$CI + jointab$PT))/(jointab$popindex*jointab$deflator))
jointab = cbind(jointab ,"ln_taxrev" =ln_taxrev )
tax_obs = jointab[, c("date" , "ln_taxrev")]
tax_obs[-1,2] = diff(tax_obs[,2])
tax_obs = betweendates(DATE1,DATE2,tax_obs)
tax_obs[,2] = (tax_obs[,2] - mean(tax_obs[,2]))
datalist[["tax_obs"]] <- tax_obs
if (exists("RunALL") == FALSE ) {write_xlsx(datalist, path = "datalist.xlsx", col_names = TRUE)} else if (RunALL==0){write_xlsx(datalist, path = "datalist.xlsx", col_names = TRUE)}
if (exists("RunALL") == FALSE ) {source("housekeeping.R")} else if (RunALL==0){source("housekeeping.R")}
# first calculate government transfer
tmp.vindates<- as.Date(fredr_series_vintagedates(series_id = "W014RC1Q027SBEA")[[1]])
closest_date <- clost_vin_search(tmp.vindates, ref.vin.date )
series.data.Ctp <- as.data.frame(fredr_series_observations(series_id = "W014RC1Q027SBEA", frequency = "q", vintage_dates = closest_date))
series.data.Ctp$date <- as.Date(series.data.Ctp$date)
names(series.data.Ctp)[names(series.data.Ctp) == "value"] <- "ctp"
View(series.data.Ctp)
